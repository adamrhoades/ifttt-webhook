<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>ifttt-webhook by captn3m0</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>ifttt-webhook</h1>
        <p>A webhook middleware for the ifttt.com service</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/captn3m0/ifttt-webhook" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/captn3m0/ifttt-webhook/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/captn3m0/ifttt-webhook/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h1>
<a name="ifttt-webhook" class="anchor" href="#ifttt-webhook"><span class="octicon octicon-link"></span></a>ifttt-webhook</h1>

<p>A webhook middleware for the ifttt.com service</p>

<h1>
<a name="how-to-use" class="anchor" href="#how-to-use"><span class="octicon octicon-link"></span></a>How To Use</h1>

<ol>
<li>Change your ifttt.com wordpress server to <a href="http://ifttt.captnemo.in">http://ifttt.captnemo.in</a>.</li>
<li>You can use any username/password combination you want. ifttt will accept the authentication irrespective of what details you enter here. These details will be passed along by the webhook as well, so that you may use these as your authentication medium, perhaps.</li>
<li>Create a recipe in ifttt which would post to your "wordpress channel". In the "Tags" field, use the webhook url that you want to use.</li>
</ol><p><img src="http://i.imgur.com/RA0Jb.png" alt="Connecting to ifttt-webhook" title="You can type in any username/password you want"></p>

<p>Any username/password combination will be accepted, and passed through to the webhook url. A blank password is considered valid, but ifttt invalidates a blank username.</p>

<p><img src="http://i.imgur.com/kPpufmZ.png" alt="Screenshot of a channel" title="Sample Channel for use as a webhook"></p>

<p>Make sure that the url you specify accepts POST requests. (Use <a href="http://requestb.in/">requestbin</a> for debugging.) The url is only picked up from the description field, and all other fields are passed through to the webhook url. The post status should ideally be set to "Publish Immediately", but anything else should work as well.</p>

<h1>
<a name="how-it-works" class="anchor" href="#how-it-works"><span class="octicon octicon-link"></span></a>How It Works</h1>

<p>ifttt uses wordpress-xmlrpc to communicate with the wordpress blog. We present a fake-xmlrpc interface on the webadress, which causes ifttt to be fooled into thinking of this as a genuine wordpress blog. The only action that ifttt allows for wordpress is posting, which is used for powering webhooks. All the other fields (title, categories) along with the username/password credentials are passed along by the webhook. Do not use the "Create a photo post" action for wordpress, as ifttt manually adds a <code>&lt;img&gt;</code> tag in the description pointing to what url you pass. Its better to pass the url in clear instead (using body field).</p>

<h1>
<a name="why" class="anchor" href="#why"><span class="octicon octicon-link"></span></a>Why</h1>

<p>There has been a lot of <a href="http://blog.jazzychad.net/2012/08/05/ifttt-needs-webhooks-stat.html">call</a> for a ifttt-webhook. I had asked about it pretty early on, but ifttt has yet to create such a channel. It was fun to build and will allow me to hookup ifttt with things like <a href="http://partychat-hooks.appspot.com/" title="Partychat Hooks">partychat</a>, <a href="https://help.github.com/articles/post-receive-hooks/" title="Github Post receive hooks">github</a> and many other awesome services for which ifttt is yet to build a channel. You can build a postmarkapp.com like email-to-webhook service using ifttt alone. Wordpress seems to be the only channel on ifttt that supports custom domains, and hence can be used as a middleware. The ifttt-webhook also propogates errors on connecting to the webhook back to ifttt. This means that an Internal Server Error will be recognized as an error by ifttt, and reported as such. You won't be getting any debug information from this side (ifttt doesn't show that in logs), so debug on your webhook side by proper logging.</p>

<h1>
<a name="payload" class="anchor" href="#payload"><span class="octicon octicon-link"></span></a>Payload</h1>

<p>The following information is passed along by the webhook in the raw body of the post request in json encoded format.</p>

<div class="highlight highlight-json"><pre><span class="p">{</span>
  <span class="err">user:</span> <span class="nt">"username specified in ifttt"</span><span class="p">,</span>
  <span class="err">password:</span> <span class="nt">"password specified in ifttt"</span><span class="p">,</span>
  <span class="err">title:</span> <span class="nt">"title generated for the recipe in ifttt"</span><span class="p">,</span>
  <span class="err">categories:</span> <span class="err">['array','of','categories','passed'],</span>
<span class="p">}</span>
</pre></div>

<p>To get the data from the POST request, you can use any of the following:</p>

<div class="highlight highlight-php"><pre><span class="nv">$data</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">'php://input'</span><span class="p">));</span> <span class="c1">//php</span>
<span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="o">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">request</span><span class="o">.</span><span class="nx">body</span><span class="o">.</span><span class="nx">read</span><span class="p">)</span> <span class="c1">#ruby-sinatra</span>
</pre></div>

<h1>
<a name="licence" class="anchor" href="#licence"><span class="octicon octicon-link"></span></a>Licence</h1>

<p>Licenced under GPL. Some portions of the code are from wordpress itself. You should probably host this on your own server, instead of using <code>ifttt.captnemoin</code>. I recommend using <a href="http://heroku.com">Heroku</a> for excellent php hosting. (<a href="http://stackoverflow.com/questions/13334052/does-heroku-support-php">Heroku does supports PHP</a>)</p>

<h1>
<a name="custom-use" class="anchor" href="#custom-use"><span class="octicon octicon-link"></span></a>Custom Use</h1>

<p>Just clone the git repo to some place, and use that as the wordpress installation location in ifttt.com channel settings.</p>

<h1>
<a name="changelog" class="anchor" href="#changelog"><span class="octicon octicon-link"></span></a>Changelog</h1>

<ul>
<li>Shifted URL from Tags field to Description(Body) field. (Oct 26 2013)</li>
<li>Shifted <code>ifttt.captnemo.in</code> to Heroku (Oct 7 2013)</li>
</ul>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/captn3m0">captn3m0</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-5922129-9");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>